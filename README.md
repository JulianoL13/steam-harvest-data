# üéÆ Steam Data Harvester

Um scraper robusto e otimizado para coletar dados de jogos da Steam usando proxies rotativos, processamento paralelo e toler√¢ncia a falhas.

## üìã √çndice

- [Caracter√≠sticas](#-caracter√≠sticas)
- [Instala√ß√£o](#-instala√ß√£o)
- [Uso B√°sico](#-uso-b√°sico)
- [Configura√ß√£o de Proxies](#-configura√ß√£o-de-proxies)
- [Modos de Opera√ß√£o](#-modos-de-opera√ß√£o)
- [Par√¢metros](#-par√¢metros)
- [Exemplos](#-exemplos)
- [Arquivos de Sa√≠da](#-arquivos-de-sa√≠da)
- [Logs e Monitoramento](#-logs-e-monitoramento)
- [Toler√¢ncia a Falhas](#-toler√¢ncia-a-falhas)
- [Estrutura do Projeto](#-estrutura-do-projeto)
- [Contribuindo](#-contribuindo)

## ‚ú® Caracter√≠sticas

- **üöÄ Processamento Paralelo**: Utiliza m√∫ltiplas threads para maximizar efici√™ncia
- **üîÑ Rota√ß√£o de Proxies**: Suporte autom√°tico a m√∫ltiplos proxies com fallback
- **üíæ Toler√¢ncia a Falhas**: Sistema de cursor para retomar execu√ß√£o ap√≥s interrup√ß√µes
- **üìä Monitoramento**: Logs detalhados com progresso e estat√≠sticas
- **üéØ Controle Preciso**: Limite exato de jogos coletados (evita overrun)
- **üìù Valida√ß√£o**: Filtragem autom√°tica de jogos v√°lidos vs DLCs/apps n√£o-jogo
- **‚ö° Otimizado**: Rate limiting inteligente e retry com backoff exponencial
- **üîí Thread-Safe**: Opera√ß√µes seguras em ambiente multi-threaded

## üì¶ Instala√ß√£o

### Depend√™ncias

```bash
pip install requests
```

### Clone/Download

```bash
git clone <seu-repositorio>
cd steam-harvest-data
```

ou simplesmente baixe o arquivo `scrapper.py`.

## üöÄ Uso B√°sico

### Comando Simples (Modo Sequencial)

```bash
python scrapper.py --max_games 10 --max_reviews 5
```

### Modo Paralelo (Recomendado)

```bash
python scrapper.py --parallel --workers 8 --max_games 50 --max_reviews 10
```

### Com Proxies

```bash
python scrapper.py --parallel --workers 5 --proxies proxies.txt --max_games 100
```

## üåê Configura√ß√£o de Proxies

Crie um arquivo `proxies.txt` com seus proxies:

```
# Formato: um proxy por linha ou separados por v√≠rgula
proxy1.example.com:8080
proxy2.example.com:3128
username:password@proxy3.example.com:8080

# Ou em uma linha separados por v√≠rgula:
proxy1.com:8080,proxy2.com:3128,proxy3.com:8080
```

**Formatos Suportados:**
- `proxy.com:8080`
- `http://proxy.com:8080`
- `https://proxy.com:8080`
- `username:password@proxy.com:8080`

O script automaticamente adiciona `https://` se n√£o especificado.

## üîß Modos de Opera√ß√£o

### Modo Sequencial
- Usa apenas IP local
- Processamento um jogo por vez
- Mais lento, mas mais conservador
- Ideal para testes ou uso casual

### Modo Paralelo
- Utiliza m√∫ltiplas threads
- Rota√ß√£o autom√°tica de proxies
- Processamento otimizado
- **Recomendado para coleta em larga escala**

## ‚öôÔ∏è Par√¢metros

| Par√¢metro | Tipo | Padr√£o | Descri√ß√£o |
|-----------|------|--------|-----------|
| `--max_games` | int | 10 | N√∫mero m√°ximo de jogos v√°lidos a coletar |
| `--max_reviews` | int | 10 | Reviews por jogo (0 = sem reviews) |
| `--parallel` | flag | False | Ativa modo paralelo |
| `--workers` | int | 8 | N√∫mero de threads (modo paralelo) |
| `--proxies` | str | None | Arquivo com lista de proxies |
| `--batch_size` | int | 200 | Tamanho do lote para processamento |
| `--cursor_file` | str | scraper_cursor.txt | Arquivo de cursor para retomada |
| `--reset_cursor` | flag | False | Ignora cursor e recome√ßa do zero |
| `--game_details_file` | str | game_details.jsonl | Arquivo de sa√≠da dos detalhes |
| `--game_reviews_file` | str | game_reviews.jsonl | Arquivo de sa√≠da das reviews |
| `--checkpoint_interval` | int | 25 | Intervalo para salvar progresso |

## üìù Exemplos

### Coleta R√°pida (Poucos Jogos)
```bash
# 20 jogos, 3 reviews cada, modo paralelo
python scrapper.py --parallel --max_games 20 --max_reviews 3 --workers 4
```

### Coleta em Larga Escala
```bash
# 500 jogos com proxies, 10 reviews cada
python scrapper.py --parallel --workers 10 --proxies proxies.txt --max_games 500 --max_reviews 10
```

### Coleta Apenas Detalhes (Sem Reviews)
```bash
# Coleta apenas informa√ß√µes dos jogos, sem reviews
python scrapper.py --parallel --max_games 100 --max_reviews 0
```

### Retomar Execu√ß√£o Interrompida
```bash
# Continua de onde parou (usa cursor autom√°tico)
python scrapper.py --parallel --max_games 200
```

### Recome√ßar do Zero
```bash
# Ignora progresso anterior e recome√ßa
python scrapper.py --reset_cursor --max_games 50
```

## üìÅ Arquivos de Sa√≠da

### game_details.jsonl
Cont√©m detalhes completos dos jogos em formato JSONL:

```json
{
  "appid": 570,
  "name": "Dota 2",
  "type": "game",
  "steam_appid": 570,
  "required_age": 0,
  "is_free": true,
  "detailed_description": "...",
  "short_description": "...",
  "header_image": "https://...",
  "website": "http://...",
  "developers": ["Valve"],
  "publishers": ["Valve"],
  "price_overview": {...},
  "categories": [...],
  "genres": [...],
  "screenshots": [...],
  "release_date": {...}
}
```

### game_reviews.jsonl
Cont√©m reviews dos jogos:

```json
{
  "appid": 570,
  "recommendationid": "123456789",
  "author": {
    "steamid": "...",
    "num_games_owned": 150,
    "num_reviews": 5,
    "playtime_forever": 1200,
    "playtime_last_two_weeks": 50
  },
  "language": "english",
  "review": "Great game! Highly recommended...",
  "timestamp_created": 1692661200,
  "timestamp_updated": 1692661200,
  "voted_up": true,
  "votes_up": 25,
  "votes_funny": 2,
  "comment_count": 3
}
```

## üìä Logs e Monitoramento

### Logs no Console
```
2025-08-22 10:30:15 - MainThread - INFO - üöÄ INICIANDO Steam Scraper Otimizado
2025-08-22 10:30:15 - MainThread - INFO - üéØ Meta: 50 jogos | Reviews: 10 por jogo
2025-08-22 10:30:15 - MainThread - INFO - üì° Carregados 5 proxies v√°lidos
2025-08-22 10:30:16 - MainThread - INFO - üì¶ 125000 jogos obtidos da Steam API
2025-08-22 10:30:20 - ThreadPoolExecutor-0_1 - INFO - üéÆ JOGO V√ÅLIDO: 730 - Counter-Strike 2
2025-08-22 10:30:21 - ThreadPoolExecutor-0_2 - INFO - üìù 10 reviews salvos para 730
2025-08-22 10:30:22 - MainThread - INFO - üìà Progresso paralelo: 15/50
```

### Arquivo de Log
Al√©m do console, logs s√£o salvos em `steam_scraper.log` para an√°lise posterior.

### Monitoramento de Progresso
- **ETA**: Estimativa de tempo restante baseada na taxa atual
- **Taxa**: Jogos processados por minuto
- **Progresso**: Contagem atual vs meta
- **Status de Proxies**: Proxies funcionais vs falhados

## üîÑ Toler√¢ncia a Falhas

### Sistema de Cursor
- **Autom√°tico**: Salva progresso a cada N jogos processados
- **Recupera√ß√£o**: Retoma automaticamente do √∫ltimo ponto salvo
- **Prote√ß√£o**: Evita reprocessar jogos j√° coletados

### Arquivos de Estado
- `scraper_cursor.txt.progress`: Estado completo (JSON)
- `scraper_cursor.txt.backup`: Backup autom√°tico
- `steam_scraper.log`: Log hist√≥rico

### Recupera√ß√£o de Proxies
- **Rota√ß√£o Autom√°tica**: Troca proxy em caso de falha
- **Fallback para IP Local**: Continua funcionando sem proxies
- **Rate Limiting**: Respeita limites da Steam API

### Interrup√ß√£o Graceful
- **Ctrl+C**: Salva estado e finaliza limpo
- **Meta Atingida**: Para imediatamente ao atingir --max_games
- **Timeout**: Evita travamentos em requests lentas

## üìÅ Estrutura do Projeto

```
steam-harvest-data/
‚îú‚îÄ‚îÄ scrapper.py              # Script principal
‚îú‚îÄ‚îÄ README.md               # Esta documenta√ß√£o
‚îú‚îÄ‚îÄ proxies.txt             # Lista de proxies (voc√™ cria)
‚îú‚îÄ‚îÄ game_details.jsonl      # Sa√≠da: detalhes dos jogos
‚îú‚îÄ‚îÄ game_reviews.jsonl      # Sa√≠da: reviews dos jogos
‚îú‚îÄ‚îÄ scraper_cursor.txt.progress  # Estado do cursor
‚îú‚îÄ‚îÄ scraper_cursor.txt.backup    # Backup do cursor
‚îî‚îÄ‚îÄ steam_scraper.log       # Logs detalhados
```

## üõ†Ô∏è Configura√ß√£o Avan√ßada

### Otimiza√ß√£o de Performance

```bash
# Para m√°xima velocidade (requer proxies robustos)
python scrapper.py \
    --parallel \
    --workers 15 \
    --batch_size 500 \
    --checkpoint_interval 50 \
    --proxies proxies.txt \
    --max_games 1000
```

### Configura√ß√£o Conservadora

```bash
# Para evitar rate limits (mais lento, mais seguro)
python scrapper.py \
    --parallel \
    --workers 3 \
    --batch_size 100 \
    --checkpoint_interval 10 \
    --max_games 200
```

### Modo Debug

Para desenvolvimento ou debug, modifique o n√≠vel de log no c√≥digo:

```python
logging.basicConfig(level=logging.DEBUG)  # Mais detalhes
```

## ‚ö†Ô∏è Limita√ß√µes e Considera√ß√µes

### Rate Limits
- A Steam API tem limites de rate
- Use proxies para aumentar throughput
- O script implementa backoff autom√°tico

### Qualidade dos Dados
- Apenas jogos v√°lidos (n√£o DLCs)
- Filtragem autom√°tica de apps inv√°lidos
- Valida√ß√£o de dados JSON

### Recursos do Sistema
- Modo paralelo usa mais CPU e mem√≥ria
- Ajuste `--workers` conforme sua m√°quina
- Monitorar uso de rede com proxies

## üêõ Solu√ß√£o de Problemas

### Script n√£o finaliza
- Verifique se n√£o h√° proxies lentos/travados
- Reduza `--workers` se sistema sobrecarregado
- Use Ctrl+C para interrup√ß√£o graceful

### Poucos jogos encontrados
- Lista da Steam cont√©m muitos apps n√£o-jogo
- Normal encontrar ~5-10% de jogos v√°lidos
- Aumente `--max_games` se necess√°rio

### Erros de proxy
- Verifique formato do arquivo `proxies.txt`
- Teste proxies manualmente
- Script continua com IP local se proxies falharem

### Arquivo corrompido
- O script usa backups autom√°ticos
- Delete arquivos de estado para recome√ßar
- Use `--reset_cursor` para for√ßar reset

## üìà Estat√≠sticas de Performance

### Benchmarks T√≠picos
- **Sem Proxies**: ~10-20 jogos/minuto
- **Com 5 Proxies**: ~50-100 jogos/minuto  
- **10+ Proxies**: ~100-200 jogos/minuto

### Fatores que Afetam Performance
- Qualidade e velocidade dos proxies
- N√∫mero de workers
- Quantidade de reviews por jogo
- Rate limits da Steam

## ü§ù Contribuindo

1. Fork o projeto
2. Crie uma branch (`git checkout -b feature/nova-funcionalidade`)
3. Commit suas mudan√ßas (`git commit -am 'Adiciona nova funcionalidade'`)
4. Push para a branch (`git push origin feature/nova-funcionalidade`)
5. Abra um Pull Request

## üìÑ Licen√ßa

Este projeto √© disponibilizado "como est√°" para fins educacionais e de pesquisa. Use responsavelmente e respeite os termos de servi√ßo da Steam.

## ‚ö° Quick Start

```bash
# 1. Instalar depend√™ncias
pip install requests

# 2. Coleta b√°sica (10 jogos)
python scrapper.py --parallel --max_games 10

# 3. Com proxies (se dispon√≠vel)
echo "proxy1.com:8080,proxy2.com:8080" > proxies.txt
python scrapper.py --parallel --proxies proxies.txt --max_games 50

# 4. Verificar resultados
wc -l game_details.jsonl
head -1 game_details.jsonl | python -m json.tool
```

---

**üéÆ Happy Scraping!** 

Para d√∫vidas ou problemas, abra uma issue no reposit√≥rio.
